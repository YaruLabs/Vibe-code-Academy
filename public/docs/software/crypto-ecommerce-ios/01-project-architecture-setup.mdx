
# ğŸ—ï¸ Phase 1: iOS Project Architecture & Foundation

We're building an **enterprise-grade e-commerce platform** with blockchain payments. This phase establishes a solid foundation using **Clean Architecture**, **MVVM pattern**, and **SwiftUI best practices**.

This approach ensures scalability, testability, and maintainability for production deployment.

---

## âš¡ ACTION: ARCHITECT THE iOS PROJECT

**Mission:** Use your **AI Assistant** (Claude recommended). Copy the prompt below and paste it into the chat.

<div style={{
  background: 'linear-gradient(135deg, #1e40af, #7c3aed)',
  padding: '3px',
  borderRadius: '16px',
  margin: '30px 0',
  boxShadow: '0 0 60px -15px rgba(30, 64, 175, 0.6)'
}}>
  <div style={{
    background: '#0a0f1e',
    borderRadius: '13px',
    color: '#e2e8f0',
    overflow: 'hidden',
    fontFamily: 'Menlo, Monaco, Consolas, monospace',
    position: 'relative'
  }}>

    {/* Header Bar */}
    <div style={{
      background: 'rgba(255, 255, 255, 0.05)',
      borderBottom: '1px solid #334155',
      padding: '12px 20px',
      display: 'flex',
      justifyContent: 'space-between',
      alignItems: 'center'
    }}>
      <div style={{display: 'flex', alignItems: 'center', gap: '12px'}}>
        <div style={{
            width:'12px', height:'12px', background:'#1e40af', borderRadius:'50%',
            boxShadow:'0 0 12px #1e40af'
        }}></div>
        <span style={{color: '#60a5fa', fontWeight: 'bold', fontSize: '0.85rem', letterSpacing: '0.5px'}}>
          SWIFT_ECOMMERCE_ARCHITECT.prompt
        </span>
        <span style={{
            background: 'rgba(124, 58, 237, 0.2)', color: '#c4b5fd', fontSize: '0.65rem',
            padding: '2px 8px', borderRadius: '4px', border: '1px solid rgba(124, 58, 237, 0.3)'
        }}>CLEAN ARCHITECTURE</span>
      </div>

      <button
        style={{
            background: 'linear-gradient(90deg, #1e40af, #7c3aed)',
            border: 'none',
            color: 'white',
            padding: '8px 16px',
            borderRadius: '6px',
            fontSize: '0.75rem',
            cursor: 'pointer',
            fontWeight: 'bold',
            display: 'flex', alignItems: 'center', gap: '8px',
            transition: 'transform 0.1s',
            boxShadow: '0 4px 12px rgba(30, 64, 175, 0.4)'
        }}
        onMouseOver={(e) => e.currentTarget.style.transform = 'translateY(-1px)'}
        onMouseOut={(e) => e.currentTarget.style.transform = 'translateY(0)'}
        onClick={() => {
            const promptText = document.getElementById('architecture-prompt').innerText;
            navigator.clipboard.writeText(promptText);
            alert("iOS Architecture Blueprint Copied! ğŸ—ï¸");
        }}
      >
        <span>âš¡ COPY ARCHITECTURE PROMPT</span>
      </button>
    </div>

    {/* Scrollable Content Area */}
    <div id="architecture-prompt" style={{
      padding: '24px',
      maxHeight: '500px',
      overflowY: 'auto',
      whiteSpace: 'pre-wrap',
      fontSize: '0.85rem',
      lineHeight: '1.6',
      color: '#cbd5e1'
    }}>
{`You are a senior iOS architect specializing in SwiftUI, Clean Architecture, and blockchain integration. Your task is to create a complete, production-ready iOS e-commerce application architecture that accepts cryptocurrency payments via COTI blockchain.

====================================================================
ğŸ¯ PROJECT REQUIREMENTS
====================================================================

Application Type: Native iOS E-Commerce Platform with Crypto Payments
Target iOS Version: iOS 16.0+
Architecture Pattern: Clean Architecture + MVVM
UI Framework: SwiftUI
Blockchain: COTI Testnet (EVM-compatible)
Payment Methods: COTI tokens (native and custom ERC20)

====================================================================
ğŸ“ ARCHITECTURE LAYERS (STRICT SEPARATION)
====================================================================

1. DOMAIN LAYER (Business Logic - Framework Independent)
   - Entities: Product, Order, User, Transaction, Wallet
   - Use Cases:
     * GetProductsUseCase
     * AddToCartUseCase
     * ProcessPaymentUseCase
     * ConnectWalletUseCase
     * TrackOrderUseCase
   - Repository Protocols (interfaces only)
   - No UIKit, no SwiftUI, no third-party dependencies

2. DATA LAYER (Implementations)
   - Repository Implementations
   - Network Service (REST API for product catalog)
   - Blockchain Service (Web3, smart contract interactions)
   - Local Storage (UserDefaults, CoreData for cart)
   - DTOs and Mappers (API models â†’ Domain entities)

3. PRESENTATION LAYER (SwiftUI Views + ViewModels)
   - Views: Pure SwiftUI, no business logic
   - ViewModels: ObservableObject, handle UI state
   - Coordinators/Routers: Navigation logic
   - ViewModels communicate with Use Cases only

====================================================================
ğŸ“ REQUIRED FOLDER STRUCTURE
====================================================================

CryptoStore/
â”œâ”€â”€ App/
â”‚   â”œâ”€â”€ CryptoStoreApp.swift
â”‚   â””â”€â”€ AppCoordinator.swift
â”œâ”€â”€ Domain/
â”‚   â”œâ”€â”€ Entities/
â”‚   â”‚   â”œâ”€â”€ Product.swift
â”‚   â”‚   â”œâ”€â”€ Order.swift
â”‚   â”‚   â”œâ”€â”€ CartItem.swift
â”‚   â”‚   â”œâ”€â”€ User.swift
â”‚   â”‚   â”œâ”€â”€ Wallet.swift
â”‚   â”‚   â””â”€â”€ PaymentTransaction.swift
â”‚   â”œâ”€â”€ UseCases/
â”‚   â”‚   â”œâ”€â”€ Products/
â”‚   â”‚   â”‚   â”œâ”€â”€ GetProductsUseCase.swift
â”‚   â”‚   â”‚   â””â”€â”€ GetProductDetailsUseCase.swift
â”‚   â”‚   â”œâ”€â”€ Cart/
â”‚   â”‚   â”‚   â”œâ”€â”€ AddToCartUseCase.swift
â”‚   â”‚   â”‚   â”œâ”€â”€ RemoveFromCartUseCase.swift
â”‚   â”‚   â”‚   â””â”€â”€ GetCartUseCase.swift
â”‚   â”‚   â”œâ”€â”€ Payment/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProcessPaymentUseCase.swift
â”‚   â”‚   â”‚   â”œâ”€â”€ VerifyPaymentUseCase.swift
â”‚   â”‚   â”‚   â””â”€â”€ GetPaymentStatusUseCase.swift
â”‚   â”‚   â””â”€â”€ Wallet/
â”‚   â”‚       â”œâ”€â”€ ConnectWalletUseCase.swift
â”‚   â”‚       â”œâ”€â”€ GetBalanceUseCase.swift
â”‚   â”‚       â””â”€â”€ DisconnectWalletUseCase.swift
â”‚   â””â”€â”€ RepositoryProtocols/
â”‚       â”œâ”€â”€ ProductRepositoryProtocol.swift
â”‚       â”œâ”€â”€ OrderRepositoryProtocol.swift
â”‚       â”œâ”€â”€ WalletRepositoryProtocol.swift
â”‚       â””â”€â”€ PaymentRepositoryProtocol.swift
â”œâ”€â”€ Data/
â”‚   â”œâ”€â”€ Repositories/
â”‚   â”‚   â”œâ”€â”€ ProductRepository.swift
â”‚   â”‚   â”œâ”€â”€ OrderRepository.swift
â”‚   â”‚   â”œâ”€â”€ WalletRepository.swift
â”‚   â”‚   â””â”€â”€ PaymentRepository.swift
â”‚   â”œâ”€â”€ Network/
â”‚   â”‚   â”œâ”€â”€ APIClient.swift
â”‚   â”‚   â”œâ”€â”€ Endpoints.swift
â”‚   â”‚   â””â”€â”€ DTOs/
â”‚   â”‚       â”œâ”€â”€ ProductDTO.swift
â”‚   â”‚       â””â”€â”€ OrderDTO.swift
â”‚   â”œâ”€â”€ Blockchain/
â”‚   â”‚   â”œâ”€â”€ Web3Manager.swift
â”‚   â”‚   â”œâ”€â”€ ContractManager.swift
â”‚   â”‚   â”œâ”€â”€ TransactionManager.swift
â”‚   â”‚   â””â”€â”€ WalletConnectManager.swift
â”‚   â””â”€â”€ Local/
â”‚       â”œâ”€â”€ CartStorageService.swift
â”‚       â””â”€â”€ UserDefaultsManager.swift
â”œâ”€â”€ Presentation/
â”‚   â”œâ”€â”€ Screens/
â”‚   â”‚   â”œâ”€â”€ Home/
â”‚   â”‚   â”‚   â”œâ”€â”€ HomeView.swift
â”‚   â”‚   â”‚   â””â”€â”€ HomeViewModel.swift
â”‚   â”‚   â”œâ”€â”€ ProductCatalog/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCatalogView.swift
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCatalogViewModel.swift
â”‚   â”‚   â”‚   â”œâ”€â”€ ProductCardView.swift
â”‚   â”‚   â”‚   â””â”€â”€ ProductDetailView.swift
â”‚   â”‚   â”œâ”€â”€ Cart/
â”‚   â”‚   â”‚   â”œâ”€â”€ CartView.swift
â”‚   â”‚   â”‚   â”œâ”€â”€ CartViewModel.swift
â”‚   â”‚   â”‚   â””â”€â”€ CartItemRowView.swift
â”‚   â”‚   â”œâ”€â”€ Checkout/
â”‚   â”‚   â”‚   â”œâ”€â”€ CheckoutView.swift
â”‚   â”‚   â”‚   â”œâ”€â”€ CheckoutViewModel.swift
â”‚   â”‚   â”‚   â””â”€â”€ PaymentConfirmationView.swift
â”‚   â”‚   â”œâ”€â”€ Wallet/
â”‚   â”‚   â”‚   â”œâ”€â”€ WalletView.swift
â”‚   â”‚   â”‚   â”œâ”€â”€ WalletViewModel.swift
â”‚   â”‚   â”‚   â””â”€â”€ WalletConnectView.swift
â”‚   â”‚   â””â”€â”€ Orders/
â”‚   â”‚       â”œâ”€â”€ OrderHistoryView.swift
â”‚   â”‚       â”œâ”€â”€ OrderHistoryViewModel.swift
â”‚   â”‚       â””â”€â”€ OrderDetailView.swift
â”‚   â”œâ”€â”€ Components/
â”‚   â”‚   â”œâ”€â”€ LoadingView.swift
â”‚   â”‚   â”œâ”€â”€ ErrorView.swift
â”‚   â”‚   â”œâ”€â”€ EmptyStateView.swift
â”‚   â”‚   â”œâ”€â”€ PriceTagView.swift
â”‚   â”‚   â””â”€â”€ CryptoBalanceView.swift
â”‚   â””â”€â”€ Navigation/
â”‚       â””â”€â”€ AppNavigationCoordinator.swift
â”œâ”€â”€ Core/
â”‚   â”œâ”€â”€ DependencyInjection/
â”‚   â”‚   â””â”€â”€ DIContainer.swift
â”‚   â”œâ”€â”€ Extensions/
â”‚   â”‚   â”œâ”€â”€ String+Extensions.swift
â”‚   â”‚   â”œâ”€â”€ Double+Extensions.swift
â”‚   â”‚   â””â”€â”€ Color+Extensions.swift
â”‚   â”œâ”€â”€ Constants/
â”‚   â”‚   â”œâ”€â”€ AppConstants.swift
â”‚   â”‚   â””â”€â”€ BlockchainConstants.swift
â”‚   â””â”€â”€ Utilities/
â”‚       â”œâ”€â”€ Logger.swift
â”‚       â””â”€â”€ FormatHelper.swift
â””â”€â”€ Resources/
    â”œâ”€â”€ Assets.xcassets
    â””â”€â”€ Info.plist

====================================================================
ğŸ”§ DEPENDENCIES (SPM - Swift Package Manager)
====================================================================

REQUIRED packages to add via Xcode:
1. web3.swift - Blockchain interactions
   https://github.com/argentlabs/web3.swift
2. WalletConnectSwiftV2 - Wallet connection
   https://github.com/WalletConnect/WalletConnectSwiftV2
3. BigInt - Large number handling for crypto
   https://github.com/attaswift/BigInt

====================================================================
ğŸ“ CODE REQUIREMENTS
====================================================================

SECTION 1 - Domain Entities (Examples)

Product Entity must include:
- id: UUID
- name: String
- description: String
- priceInCOTI: Decimal
- priceInUSD: Decimal (for display)
- imageURL: URL
- category: ProductCategory enum
- stockQuantity: Int
- isAvailable: Bool

Order Entity must include:
- id: UUID
- userId: String
- items: [CartItem]
- totalAmount: Decimal
- paymentStatus: PaymentStatus enum
- transactionHash: String?
- timestamp: Date
- deliveryAddress: Address?

SECTION 2 - Use Cases (Protocol-Oriented)

Each use case must:
- Be a protocol with execute() method
- Have a concrete implementation
- Inject repository dependencies via initializer
- Return Result<Success, Error> type
- Be fully testable (mockable repositories)

Example structure:
protocol GetProductsUseCase {
    func execute() async throws -> [Product]
}

SECTION 3 - ViewModels (ObservableObject)

Each ViewModel must:
- Conform to ObservableObject
- Use @Published for state properties
- Inject use cases via initializer
- Handle loading, error, and success states
- Use async/await for asynchronous operations
- Never import Foundation types into Domain layer

SECTION 4 - SwiftUI Views

Must follow:
- Single Responsibility Principle
- Extract subviews for complex UI
- Use @StateObject for owned ViewModels
- Use @EnvironmentObject for shared state
- Implement proper accessibility labels
- Support Dark Mode
- Use SF Symbols for icons

SECTION 5 - Dependency Injection Container

Create a DIContainer that:
- Registers all repositories
- Registers all use cases
- Provides factory methods
- Supports lazy initialization
- Enables easy testing with mocks

====================================================================
ğŸ¨ UI/UX REQUIREMENTS
====================================================================

Design System:
- Color Palette: Modern, crypto-themed (blues, purples, dark mode friendly)
- Typography: SF Pro (system font), clear hierarchy
- Spacing: 8pt grid system
- Corner Radius: Consistent (8pt, 12pt, 16pt)
- Shadows: Subtle depth
- Animations: Smooth, 0.3s default duration

Key Screens Layout:
1. Home: Featured products, categories, wallet connection status
2. Product Catalog: Grid layout, filters, search
3. Product Detail: Large image, description, price in COTI, add to cart
4. Cart: List of items, quantities, total in COTI, checkout button
5. Checkout: Order summary, wallet connection, payment confirmation
6. Wallet: Balance, connected wallet address, transaction history

====================================================================
ğŸ”’ SECURITY & BEST PRACTICES
====================================================================

1. Never store private keys in the app
2. Use WalletConnect for secure wallet connections
3. Validate all user inputs
4. Handle blockchain errors gracefully
5. Implement proper error messages for users
6. Use HTTPS for all API calls
7. Sanitize data before displaying
8. Implement rate limiting for API calls

====================================================================
ğŸ§ª TESTING CONSIDERATIONS
====================================================================

Structure must support:
- Unit tests for ViewModels (inject mock use cases)
- Unit tests for Use Cases (inject mock repositories)
- UI tests for critical flows
- Integration tests for blockchain interactions
- Mock implementations for all protocols

====================================================================
ğŸ“¤ DELIVERABLES
====================================================================

You must provide:

1. Complete Xcode project structure (folder organization)
2. Full implementation of:
   - All Domain entities
   - All Use Case protocols and implementations
   - All Repository protocols
   - DIContainer with dependency graph
   - At least 3 complete screen implementations (Home, ProductCatalog, Cart)
   - ViewModels for those screens
   - Reusable SwiftUI components
3. SPM package dependencies list
4. Constants file with COTI blockchain configuration:
   - RPC URL: https://testnet.coti.io/rpc
   - Chain ID: 7082400 (0x6c11a0)
   - Block Explorer: https://testnet.cotiscan.io
5. README with:
   - Setup instructions
   - Architecture explanation
   - How to run the project
   - How blockchain integration works

====================================================================
ğŸš« STRICT RULES - DO NOT
====================================================================

- Do NOT put business logic in Views or ViewModels
- Do NOT import UIKit unless absolutely necessary
- Do NOT use singletons (use DI instead)
- Do NOT hardcode blockchain addresses (use constants)
- Do NOT skip error handling
- Do NOT create God objects (keep classes focused)
- Do NOT ignore memory management (use weak references where needed)

====================================================================
âœ… VALIDATION CHECKLIST
====================================================================

Before delivering, ensure:
âœ“ All layers are properly separated
âœ“ Dependencies only flow inward (Domain â† Data â† Presentation)
âœ“ No circular dependencies
âœ“ All protocols defined before implementations
âœ“ ViewModels are testable
âœ“ UI is responsive and supports all iPhone sizes
âœ“ Dark mode works correctly
âœ“ Code is documented with comments
âœ“ No force unwraps (use guard/if let)
âœ“ Async code uses async/await (not callbacks)

====================================================================
ğŸ¯ EXPECTED OUTPUT FORMAT
====================================================================

Provide code in sections:
1. Project Structure (text tree)
2. Domain Layer Code (all files)
3. Data Layer Code (repository implementations)
4. Presentation Layer Code (views + viewmodels)
5. Core/DI Code
6. Setup Instructions

Use clean, production-ready Swift code with proper naming conventions.`}
    </div>

    {/* Visual Footer */}
    <div style={{
        background: '#020617',
        borderTop: '1px solid #1e293b',
        padding: '8px 20px',
        display: 'flex', justifyContent: 'flex-end',
        alignItems: 'center', gap: '10px'
    }}>
        <div style={{width:'8px', height:'8px', background:'#1e40af', borderRadius:'50%', animation: 'pulse 2s infinite'}}></div>
        <span style={{fontSize: '0.7rem', color: '#94a3b8', fontFamily: 'sans-serif', fontWeight: 'bold'}}>
          SCROLL TO VIEW COMPLETE ARCHITECTURE SPECS â†•
        </span>
    </div>

  </div>
</div>

---

## ğŸ“ What You'll Build

After completing this phase, you'll have:

- âœ… **Clean Architecture Foundation** - Properly separated layers
- âœ… **MVVM Pattern** - Testable ViewModels
- âœ… **Dependency Injection** - Scalable, maintainable code
- âœ… **Core Screens** - Home, Catalog, Cart with full functionality
- âœ… **Blockchain Setup** - COTI integration ready
- âœ… **Production Structure** - Ready for App Store deployment
